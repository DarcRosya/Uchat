namespace Uchat.Database.Entities;

public class Contact
{
    // ========================================================================
    // PRIMARY KEY
    // ========================================================================

    public int Id { get; set; }
    
    // ========================================================================
    // FOREIGN KEYS
    // ========================================================================
    
    /// ID владельца списка контактов 
    public int OwnerId { get; set; }
    
    /// ID пользователя, которого добавили в контакты
    public int ContactUserId { get; set; }
    
    // ========================================================================
    // ДОПОЛНИТЕЛЬНАЯ ИНФОРМАЦИЯ
    // ========================================================================
    
    /// NULL = использовать DisplayName пользователя
    /// + Только если IsFriend = true
    public string? Nickname { get; set; }

    /// Можно и будучи не друзьями
    public string? PrivateNotes { get; set; }

    /// Полезно для:
    /// - Сортировки (недавно добавленные)
    /// - Статистики (сколько контактов добавлено за месяц)
    public DateTime AddedAt { get; set; }
    
    // ========================================================================
    // ФЛАГИ
    // ========================================================================
    
    /// true = пользователь заблокирован
    /// - Не может отправлять мне сообщения + я не могу ему
    /// - Я не вижу его статус онлайн
    /// - Он не видит мой статус онлайн
    public bool IsBlocked { get; set; }

    /// true = избранный контакт
    /// - Показывается в топе списка контактов
    /// - Специальная иконка (звездочка)
    public bool IsFavorite { get; set; }

    public bool NotificationsEnabled { get; set; } = true;

    /// <summary>
    /// Время последнего сообщения с этим контактом
    /// Полезно для сортировки по активности
    /// </summary>
    public DateTime? LastMessageAt { get; set; }

    /// <summary>
    /// Общее количество сообщений между владельцем и контактом
    /// </summary>
    public int MessageCount { get; set; }
    
    // ========================================================================
    // NAVIGATION PROPERTIES
    // ========================================================================
    
    public User Owner { get; set; } = null!;
    public User ContactUser { get; set; } = null!;
}
