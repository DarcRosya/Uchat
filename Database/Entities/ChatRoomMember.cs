namespace Uchat.Database.Entities;


// Эта таблица соединяет Users и ChatRooms в отношении Many-to-Many
public class ChatRoomMember
{
    // ========================================================================
    // PRIMARY KEY
    // ========================================================================
    public int Id { get; set; }
    
    // ========================================================================
    // FOREIGN KEYS (Связи)
    // ========================================================================

    public int ChatRoomId { get; set; }
    public int UserId { get; set; }
    
    // ========================================================================
    // ВРЕМЕННЫЕ МЕТКИ
    // ========================================================================
    
    /// Когда пользователь присоединился к группе
    /// В БД: DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
    /// 
    /// Полезно для:
    /// - Сортировки участников (кто раньше вступил)
    /// - Статистики (сколько человек присоединилось за месяц)
    public DateTime JoinedAt { get; set; }

    // ========================================================================
    // ПРИГЛАШЕНИЕ
    // ========================================================================

    /// ID пользователя, который пригласил этого участника в группу
    /// 
    /// NULL = присоединился сам (публичная группа) или создатель группы
    /// 
    /// Полезно для:
    /// - Истории: кто кого пригласил (граф приглашений)
    /// - Ответственность: если пригласил спамера, можно понять кто виноват
    public int? InvitedById { get; set; }
    public ChatRoom ChatRoom { get; set; } = null!;
    public User User { get; set; } = null!;
    public User? InvitedBy { get; set; }
}